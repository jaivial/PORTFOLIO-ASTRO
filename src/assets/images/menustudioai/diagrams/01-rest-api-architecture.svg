<svg viewBox="0 0 800 500" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="headerGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#667eea"/>
      <stop offset="100%" style="stop-color:#764ba2"/>
    </linearGradient>
    <linearGradient id="boxGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#f8fafc"/>
      <stop offset="100%" style="stop-color:#e2e8f0"/>
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.15"/>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="800" height="500" fill="#f1f5f9"/>

  <!-- Title -->
  <text x="400" y="35" text-anchor="middle" font-family="system-ui" font-size="20" font-weight="bold" fill="#1e293b">REST API Architecture - Elysia.js + Bun</text>

  <!-- Client -->
  <g filter="url(#shadow)">
    <rect x="30" y="70" width="120" height="60" rx="8" fill="url(#headerGrad)"/>
    <text x="90" y="105" text-anchor="middle" font-family="system-ui" font-size="14" font-weight="600" fill="white">Client</text>
  </g>

  <!-- Arrow to Server -->
  <path d="M 150 100 L 200 100" stroke="#64748b" stroke-width="2" marker-end="url(#arrowhead)"/>
  <text x="175" y="90" text-anchor="middle" font-family="system-ui" font-size="10" fill="#64748b">HTTPS</text>

  <!-- Elysia Server Box -->
  <g filter="url(#shadow)">
    <rect x="200" y="55" width="380" height="380" rx="12" fill="white" stroke="#e2e8f0" stroke-width="2"/>
    <rect x="200" y="55" width="380" height="40" rx="12" fill="url(#headerGrad)"/>
    <text x="390" y="82" text-anchor="middle" font-family="system-ui" font-size="14" font-weight="600" fill="white">Elysia.js Server (Bun Runtime)</text>
  </g>

  <!-- Middleware Layer -->
  <rect x="220" y="110" width="340" height="50" rx="6" fill="#fef3c7" stroke="#f59e0b" stroke-width="1"/>
  <text x="390" y="140" text-anchor="middle" font-family="system-ui" font-size="12" font-weight="500" fill="#92400e">Middleware: CORS | Auth Macros | Validation | Rate Limit</text>

  <!-- Route Groups -->
  <g>
    <!-- Auth Routes -->
    <rect x="230" y="175" width="100" height="45" rx="6" fill="#dbeafe" stroke="#3b82f6" stroke-width="1"/>
    <text x="280" y="195" text-anchor="middle" font-family="system-ui" font-size="11" font-weight="600" fill="#1e40af">/auth</text>
    <text x="280" y="210" text-anchor="middle" font-family="system-ui" font-size="9" fill="#3b82f6">Login, OAuth</text>

    <!-- Images Routes -->
    <rect x="340" y="175" width="100" height="45" rx="6" fill="#dcfce7" stroke="#22c55e" stroke-width="1"/>
    <text x="390" y="195" text-anchor="middle" font-family="system-ui" font-size="11" font-weight="600" fill="#166534">/images</text>
    <text x="390" y="210" text-anchor="middle" font-family="system-ui" font-size="9" fill="#22c55e">Generate, Edit</text>

    <!-- Credits Routes -->
    <rect x="450" y="175" width="100" height="45" rx="6" fill="#fce7f3" stroke="#ec4899" stroke-width="1"/>
    <text x="500" y="195" text-anchor="middle" font-family="system-ui" font-size="11" font-weight="600" fill="#9d174d">/credits</text>
    <text x="500" y="210" text-anchor="middle" font-family="system-ui" font-size="9" fill="#ec4899">Stripe, Webhook</text>
  </g>

  <g>
    <!-- User Routes -->
    <rect x="230" y="230" width="100" height="45" rx="6" fill="#e0e7ff" stroke="#6366f1" stroke-width="1"/>
    <text x="280" y="250" text-anchor="middle" font-family="system-ui" font-size="11" font-weight="600" fill="#4338ca">/user</text>
    <text x="280" y="265" text-anchor="middle" font-family="system-ui" font-size="9" fill="#6366f1">Profile, Prefs</text>

    <!-- Moderation Routes -->
    <rect x="340" y="230" width="100" height="45" rx="6" fill="#fef9c3" stroke="#eab308" stroke-width="1"/>
    <text x="390" y="250" text-anchor="middle" font-family="system-ui" font-size="11" font-weight="600" fill="#854d0e">/moderation</text>
    <text x="390" y="265" text-anchor="middle" font-family="system-ui" font-size="9" fill="#eab308">NSFW Check</text>

    <!-- Admin Routes -->
    <rect x="450" y="230" width="100" height="45" rx="6" fill="#fee2e2" stroke="#ef4444" stroke-width="1"/>
    <text x="500" y="250" text-anchor="middle" font-family="system-ui" font-size="11" font-weight="600" fill="#991b1b">/admin/*</text>
    <text x="500" y="265" text-anchor="middle" font-family="system-ui" font-size="9" fill="#ef4444">Panel, Analytics</text>
  </g>

  <!-- Plugins Layer -->
  <rect x="220" y="290" width="340" height="50" rx="6" fill="#f0fdf4" stroke="#22c55e" stroke-width="1"/>
  <text x="390" y="320" text-anchor="middle" font-family="system-ui" font-size="12" font-weight="500" fill="#166534">Plugins: Prisma | Auth | WaveSpeed | R2 Storage | Stripe</text>

  <!-- Services Layer -->
  <rect x="220" y="355" width="340" height="50" rx="6" fill="#faf5ff" stroke="#a855f7" stroke-width="1"/>
  <text x="390" y="385" text-anchor="middle" font-family="system-ui" font-size="12" font-weight="500" fill="#7c3aed">Services: ImageService | ModerationService | EmailService</text>

  <!-- Database -->
  <g filter="url(#shadow)">
    <rect x="620" y="150" width="150" height="70" rx="8" fill="#fef3c7" stroke="#f59e0b" stroke-width="2"/>
    <text x="695" y="180" text-anchor="middle" font-family="system-ui" font-size="13" font-weight="600" fill="#92400e">MySQL</text>
    <text x="695" y="200" text-anchor="middle" font-family="system-ui" font-size="10" fill="#b45309">Prisma ORM</text>
  </g>

  <!-- External APIs -->
  <g filter="url(#shadow)">
    <rect x="620" y="240" width="150" height="90" rx="8" fill="#dbeafe" stroke="#3b82f6" stroke-width="2"/>
    <text x="695" y="265" text-anchor="middle" font-family="system-ui" font-size="12" font-weight="600" fill="#1e40af">External APIs</text>
    <text x="695" y="285" text-anchor="middle" font-family="system-ui" font-size="10" fill="#3b82f6">WaveSpeed AI</text>
    <text x="695" y="300" text-anchor="middle" font-family="system-ui" font-size="10" fill="#3b82f6">Google Vision</text>
    <text x="695" y="315" text-anchor="middle" font-family="system-ui" font-size="10" fill="#3b82f6">Stripe</text>
  </g>

  <!-- R2 Storage -->
  <g filter="url(#shadow)">
    <rect x="620" y="350" width="150" height="55" rx="8" fill="#fed7aa" stroke="#f97316" stroke-width="2"/>
    <text x="695" y="378" text-anchor="middle" font-family="system-ui" font-size="12" font-weight="600" fill="#c2410c">Cloudflare R2</text>
    <text x="695" y="393" text-anchor="middle" font-family="system-ui" font-size="10" fill="#ea580c">Image Storage</text>
  </g>

  <!-- Connecting arrows -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#64748b"/>
    </marker>
  </defs>

  <path d="M 580 185 L 618 185" stroke="#64748b" stroke-width="1.5" marker-end="url(#arrowhead)"/>
  <path d="M 580 280 L 618 280" stroke="#64748b" stroke-width="1.5" marker-end="url(#arrowhead)"/>
  <path d="M 580 375 L 618 375" stroke="#64748b" stroke-width="1.5" marker-end="url(#arrowhead)"/>

  <!-- Footer -->
  <text x="400" y="470" text-anchor="middle" font-family="system-ui" font-size="11" fill="#64748b">Request Flow: Client → Middleware → Route Handler → Plugin → Service → External API/DB</text>
</svg>
