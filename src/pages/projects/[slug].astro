---
import Layout from "../../layouts/Layout.astro";
import PageNav from "../../components/PageNav.jsx";
import LanguageProvider from "../../components/LanguageProvider";
import { getData } from "../../utils/projects";
import Footer from "../../components/Footer.jsx";
import ProjectHeader from "../../components/ProjectHeader.jsx";
import ProjectLinks from "../../components/ProjectLinks.jsx";
import ProjectTechCategories from "../../components/ProjectTechCategories.jsx";
import ProjectFeatures from "../../components/ProjectFeatures.jsx";
import ProjectTechnicalArchitecture from "../../components/ProjectTechnicalArchitecture.jsx";
import ProjectGallery from "../../components/ProjectGallery.jsx";

export const prerender = true;

export async function getStaticPaths() {
  const projects = getData();
  return projects.map((project) => ({
    params: { slug: project.slug },
    props: { project },
  }));
}

const { project } = Astro.props;
---

<Layout title={`${project.name} | Jaime Villanueva`}>
  <LanguageProvider client:load>
    <main class="relative min-h-screen overflow-x-hidden pt-16">
      <!-- Container principal responsive -->
      <div class="w-full px-4 sm:px-6 lg:px-8 max-w-7xl mx-auto">
        <!-- <PageNav title="PROYECTO" previousLink="/projects" client:visible /> -->

        <ProjectHeader project={project} client:load />

        <!-- Enlaces solo visibles en pantallas pequeñas y medianas -->
        <div class="mt-8 lg:hidden">
          <ProjectLinks project={project} client:visible />
        </div>

        <!-- Tecnologías categorizadas con todo el ancho -->
        <div class="mt-8">
          <ProjectTechCategories project={project} client:visible />
        </div>

        <!-- Layout principal responsive -->
        <section class="mt-8 lg:mt-16 mb-20 content-visibility-auto">
          <div class="grid grid-cols-1 lg:grid-cols-10 gap-6 lg:gap-8">
            <!-- Contenido principal más ancho -->
            <div class="lg:col-span-10 space-y-6">
              <ProjectFeatures project={project} client:visible />
              {project.technicalArchitecture && (
                <ProjectTechnicalArchitecture
                  architecture={project.technicalArchitecture}
                  client:visible
                />
              )}
              <ProjectGallery project={project} client:visible />
            </div>
          </div>
        </section>
      </div>
    </main>
    <Footer client:visible />
  </LanguageProvider>
</Layout>

<script>
  // Initialize client-side language handling
  import { initClientLanguage } from "../../utils/clientLanguageInit.js";
</script>
